alter table if exists webdb.games drop constraint if exists FKgne945jcsifcvy6s9dy44ueit;
alter table if exists webdb.games drop constraint if exists FKmhtkuklj000hu8rp0k7wdng5k;
alter table if exists webdb.match_participants drop constraint if exists FK72twewsei9fw3gxbt8kt7p4j7;
alter table if exists webdb.match_participants drop constraint if exists FKbb8pnariqdxcd8j7a7j0d17h3;
alter table if exists webdb.matches drop constraint if exists FKeeniokyjgo5k6rmhjujatn27i;
alter table if exists webdb.matches drop constraint if exists FKn66swy9if3qemrk5407f81hc5;
alter table if exists webdb.sport_disciplines drop constraint if exists FKjrwf8i3l2kytik3i69mlms4wc;
alter table if exists webdb.teams drop constraint if exists FKo5qehaxeuk4i5bxwpf20dvcws;
alter table if exists webdb.tournament_judges drop constraint if exists FKi3ga0q1v18vd0btj139udk09n;
alter table if exists webdb.tournament_judges drop constraint if exists FK2md06uq346e49plc77kt5337m;
alter table if exists webdb.tournament_participants drop constraint if exists FK5gcllxhpd4uublofnydb3wkum;
alter table if exists webdb.tournament_participants drop constraint if exists FKp306uig15jwvd09ldfxhwijj6;
alter table if exists webdb.tournaments drop constraint if exists FK334y16ya9u7s07gmo95m6r6w8;
alter table if exists webdb.tournaments drop constraint if exists FKrobw7525m6byh2cd9l7k0flom;
alter table if exists webdb.tournaments drop constraint if exists FKk7tnshm8iafo9skfk6tkjklft;

drop table if exists webdb.games cascade;
drop table if exists webdb.humans cascade;
drop table if exists webdb.match_participants cascade;
drop table if exists webdb.matches cascade;
drop table if exists webdb.sport_disciplines cascade;
drop table if exists webdb.sport_kinds cascade;
drop table if exists webdb.teams cascade;
drop table if exists webdb.tournament_judges cascade;
drop table if exists webdb.tournament_participants cascade;
drop table if exists webdb.tournaments cascade;

create table webdb.games (id int4 generated by default as identity, looser_score int2, winner_score int2, match_id int4 not null, winner_team_id int4, primary key (id));
create table webdb.humans (id int4 generated by default as identity, birth_date date, city varchar(40), name varchar(30) not null, patronymic varchar(30), surname varchar(30) not null, primary key (id));
create table webdb.match_participants (team_id int4 not null, match_id int4 not null, primary key (match_id, team_id));
create table webdb.matches (id int4 generated by default as identity, looser_score int2, winner_score int2, tournament_id int4 not null, winner_team_id int4, primary key (id));
create table webdb.sport_disciplines (id int4 generated by default as identity, code varchar(11), name varchar(50), sport_kind_id int4 not null, primary key (id));
create table webdb.sport_kinds (id int4 generated by default as identity, code varchar(11), name varchar(50), primary key (id));
create table webdb.teams (id int4 generated by default as identity, name varchar(30), tournament_id int4 not null, primary key (id));
create table webdb.tournament_judges (tournament_id int4 not null, human_id int4 not null, primary key (human_id, tournament_id));
create table webdb.tournament_participants (team_id int4 not null, human_id int4 not null, primary key (human_id, team_id));
create table webdb.tournaments (id int4 generated by default as identity, age_group varchar(20), category varchar(10), city varchar(35), date_from date, date_till date, format varchar(20), gender varchar(15), name varchar(30), tournament_class varchar(10), main_judge_id int4, sport_discipline_id int4 not null, winner_team_id int4, primary key (id));

alter table if exists webdb.games add constraint FKgne945jcsifcvy6s9dy44ueit foreign key (match_id) references webdb.matches;
alter table if exists webdb.games add constraint FKmhtkuklj000hu8rp0k7wdng5k foreign key (winner_team_id) references webdb.teams;
alter table if exists webdb.match_participants add constraint FK72twewsei9fw3gxbt8kt7p4j7 foreign key (team_id) references webdb.teams;
alter table if exists webdb.match_participants add constraint FKbb8pnariqdxcd8j7a7j0d17h3 foreign key (match_id) references webdb.matches;
alter table if exists webdb.matches add constraint FKeeniokyjgo5k6rmhjujatn27i foreign key (tournament_id) references webdb.tournaments;
alter table if exists webdb.matches add constraint FKn66swy9if3qemrk5407f81hc5 foreign key (winner_team_id) references webdb.teams;
alter table if exists webdb.sport_disciplines add constraint FKjrwf8i3l2kytik3i69mlms4wc foreign key (sport_kind_id) references webdb.sport_kinds;
alter table if exists webdb.teams add constraint FKo5qehaxeuk4i5bxwpf20dvcws foreign key (tournament_id) references webdb.tournaments;
alter table if exists webdb.tournament_judges add constraint FKi3ga0q1v18vd0btj139udk09n foreign key (tournament_id) references webdb.tournaments;
alter table if exists webdb.tournament_judges add constraint FK2md06uq346e49plc77kt5337m foreign key (human_id) references webdb.humans;
alter table if exists webdb.tournament_participants add constraint FK5gcllxhpd4uublofnydb3wkum foreign key (team_id) references webdb.teams;
alter table if exists webdb.tournament_participants add constraint FKp306uig15jwvd09ldfxhwijj6 foreign key (human_id) references webdb.humans;
alter table if exists webdb.tournaments add constraint FK334y16ya9u7s07gmo95m6r6w8 foreign key (main_judge_id) references webdb.humans;
alter table if exists webdb.tournaments add constraint FKrobw7525m6byh2cd9l7k0flom foreign key (sport_discipline_id) references webdb.sport_disciplines;
alter table if exists webdb.tournaments add constraint FKk7tnshm8iafo9skfk6tkjklft foreign key (winner_team_id) references webdb.teams;